---
timestamp: 'Mon Oct 13 2025 12:38:26 GMT-0400 (Eastern Daylight Time)'
parent: '[[../20251013_123826.6705abc3.md]]'
content_id: 7c032dc3dbaa8f7dccb9edaa22f56696f2e54e71a623539f27e271d8078e8ae8
---

# Commenting

Every action should have a comment including its signature, its requirements, and effects:

```typescript
  /**
   * createLabel (name: String): (label: Label)
   *
   * **requires** no Label with the given `name` already exists
   *
   * **effects** creates a new Label `l`; sets the name of `l` to `name`; returns `l` as `label`
   */
```

concept SongRecommender \[User, Song]

purpose
To introduce a new song for the user each day

principle
Each day, the system presents a new song to the user, chosen from a list of songs.
The user can listen to the song.
Recommendations refresh daily and past recommendations can be revisited.

state
a set of Users with
a set of pastRecommendations of type Songs
a set of notYetRecommendedSongs of type Songs

invariant
The intersection of RecommendedSongs and NotYetRecommendedSongs is empty

actions
addSongToCatalog(user: User, song: Song)
requires song is not in pastRecommendations or notYetRecommendedSongs for user
effect adds song to notYetRecommendedSongs for user
generateRecommendation(user: User, count: Number): Song
requires count is less than or equal to the number of songs in notYetRecommendedSongs for user
effect returns count song recommendations, moves song(s) from notYetRecommendedSongs to pastRecommendations for user
removeSong(user: User, song: Song)
requires song to be in notYetRecommendedSongs for user
effect removes song from notYetRecommendedSongs for user
async generateRecommendationFromLLM(user: User, llm: GeminiLLM, count: Number, basisSongs: Song\[]?)
effect Uses an LLM to generate count new songs and adds them to notYetRecommendedSongs. If basisSongs is provided, the new songs are based on the provided songs. If basisSongs is not provided, the new songs are based on current "trending" music that is different from the user's taste.

## Allowed Imports

```
import { Collection, Db } from "npm:mongodb";
import { Empty, ID } from "@utils/types.ts";
import { freshID } from "@utils/database.ts";
```
