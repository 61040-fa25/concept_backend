---
timestamp: 'Sun Oct 19 2025 18:44:16 GMT-0400 (Eastern Daylight Time)'
content_id: 6e34a5a39950082be4ec328b6fad5bc36dc871ac5acb4e8ce1e6453b7d401f3d
---

# file: src\mirrorMotion\ManageVideo.test.ts

```typescript
import { assertEquals, assertExists, assertNotEquals } from "jsr:@std/assert";
import { testDb } from "@utils/database.ts";
import { ID } from "@utils/types.ts";
import ManageVideoConcept from "./ManageVideoConcept.ts";
import type { User } from "./UserConcept.ts";

const BUCKET_NAME = Deno.env.get("BUCKET_NAME") || "";

const testUser = "TestUser" as User;

Deno.test("Principle: After uploading a video, it can be retrieved for analysis, syncing, or feedback ", async () => {
  const [db, client] = await testDb();
  const manageVideoConcept = new ManageVideoConcept(db, BUCKET_NAME);

  try {
    // 1. Try to upload a practice video to Google Cloud Storage
    const uploadVideoResult = await manageVideoConcept.upload({
      owner: testUser,
      videoType: "practice",
      filePath: `${Deno.cwd()}/input/testVideos/testVideo1.mp4`,
    });

    assertNotEquals(
      "error" in uploadVideoResult,
      true,
      "Upload video should not fail.",
    );
    const { video } = uploadVideoResult as { video: ID };
    assertExists(video);

    // 2. Try to upload a reference video to Google Cloud Storage
    const uploadReferenceVideoResult = await manageVideoConcept.upload({
      owner: testUser,
      videoType: "reference",
      filePath: `${Deno.cwd()}/input/testVideos/testVideo2.mp4`,
    });

    assertNotEquals(
      "error" in uploadReferenceVideoResult,
      true,
      "Upload video should not fail.",
    );
    const { video: referenceVideo } = uploadReferenceVideoResult as {
      video: ID;
    };
    assertExists(referenceVideo);
  } finally {
    await client.close();
  }
});

```
